{% extends "header.html" %}

{% block content %}
  <title>SugarFree - Home</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="../static/css/style-home.css">
  <body>
    <!-- พื้นที่คอนเทนต์ของหน้า Home -->
    <main class="page">
      <div class="container">
        <form action="{{ url_for('predict') }}" method="get">
          <button type="submit">ทำแบบประเมินโรคเบาหวาน</button>
        </form>
      </div>
      <div class="container">
      <div class="main-image">
        <img id="mainDisplay" src="../static/images/diabetes-prevention.jpg" alt="main" />
      </div>
      <div class="thumbnail-column">
        <img class="thumbnail" src="../static/images/diabetes-meaning.jpg" onclick="showImage(1)" />
        <img class="thumbnail" src="../static/images/diabetes-diagnosis.jpg" onclick="showImage(2)" />
        <img class="thumbnail" src="../static/images/diabetes-treatment-target.jpg" onclick="showImage(3)" />
        <img class="thumbnail" src="../static/images/diabetes-prevention.jpg" onclick="showImage(0)" />
      </div>
    </div>
    </main>

    <script>
      // จัดตำแหน่ง indicator + notch ให้ตรงกับปุ่มที่ active เมื่อโหลด/รีไซส์
      (function(){
        const bar = document.getElementById('tabbar');
        const indicator = bar.querySelector('.tab-indicator');
        const notch = bar.querySelector('.tab-notch');
        const tabs = Array.from(bar.querySelectorAll('.tab'));

        function moveTo(el){
          tabs.forEach(t => t.classList.remove('is-active'));
          el.classList.add('is-active');

          const r = el.getBoundingClientRect();
          const br = bar.getBoundingClientRect();
          const centerX = r.left + r.width/2 - br.left;

          indicator.style.transform = `translateX(${centerX - indicator.offsetWidth/2}px)`;
          notch.style.transform = `translateX(${centerX - notch.offsetWidth/2}px)`;
        }

        const current = bar.querySelector('.tab.is-active') || tabs[0];
        window.addEventListener('load', () => moveTo(current));
        window.addEventListener('resize', () => moveTo(current));
      })();

      const images = [
        "../static/images/diabetes-prevention.jpg",
        "../static/images/diabetes-meaning.jpg",
        "../static/images/diabetes-diagnosis.jpg",
        "../static/images/diabetes-treatment-target.jpg"
      ];

      let currentIndex = 0;
      let autoRotate = true;

      function showImage(index) {
        currentIndex = index;
        document.getElementById("mainDisplay").src = images[currentIndex];
        autoRotate = false;
      }

      setInterval(() => {
        if (autoRotate) {
          currentIndex = (currentIndex + 1) % images.length;
          document.getElementById("mainDisplay").src = images[currentIndex];
        }
      }, 9000);
    </script>

  </body>
{% endblock %}