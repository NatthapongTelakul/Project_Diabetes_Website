<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SugarFree - Home</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="../static/css/style-home.css">
</head>
<body>
  <header>
    <div class="logo">
      <h1>
        SugarFree
        <span class="subtitle">AI Diabetes Screening</span>
      </h1>
    </div>

    <!-- ข้อความ Welcome (ดึงชื่อจาก localStorage ถ้ามี) -->
    <div class="welcome" id="welcome">Welcome</div>

    <!-- ช่องค้นหา -->
    <!-- <form class="search" role="search" onsubmit="event.preventDefault();">
      <input id="q" type="search" placeholder="Search…" aria-label="Search">
      <button type="submit" aria-label="Search">
        <i class="fa fa-search" aria-hidden="true"></i>
      </button>
    </form> -->

    <!-- แถบสวิทช์หน้า: ปุ่มจะพาไปไฟล์ .html ของแต่ละหน้า -->
    <nav class="tabbar" id="tabbar">
      <span class="tab-notch" aria-hidden="true"></span>
      <span class="tab-indicator" aria-hidden="true"></span>

      <!-- หน้านี้คือ home ⇒ ใส่ is-active -->
      <button class="tab is-active" data-tab="home" aria-label="Home" onclick="location.href='home.html'">
        <i class="fa fa-home" aria-hidden="true"></i>
      </button>
      <button class="tab" data-tab="calendar" aria-label="Calendar" onclick="location.href='calendar.html'">
        <i class="fa fa-calendar" aria-hidden="true"></i>
      </button>
      <button class="tab" data-tab="profile" aria-label="Profile" onclick="location.href='profile.html'">
        <i class="fa fa-user" aria-hidden="true"></i>
      </button>
      <button class="tab" data-tab="menu" aria-label="Menu" onclick="location.href='menu.html'">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </button>
    </nav>
  </header>

  <!-- พื้นที่คอนเทนต์ของหน้า Home -->
  <main class="page">
    
    <div class="container">
    <div class="main-image">
      <img id="mainDisplay" src="../static/images/ป้องกันโรคเบาหวาน.jpg" alt="main" />
    </div>
    <div class="thumbnail-column">
      <img class="thumbnail" src="../static/images/โรคเบาหวานคือ.jpg" onclick="showImage(1)" />
      <img class="thumbnail" src="../static/images/การวินิจฉัยโรคเบาหวาน.jpg" onclick="showImage(2)" />
      <img class="thumbnail" src="../static/images/เป้าหมายการดูแล.jpg" onclick="showImage(3)" />
      <img class="thumbnail" src="../static/images/ป้องกันโรคเบาหวาน.jpg" onclick="showImage(4)" />
    </div>
  </div>
  </main>

  <script>
    // แสดงชื่อผู้ใช้แบบตัดโดเมนหลัง '@'
    window.addEventListener('load', () => {
      const raw = localStorage.getItem('userEmail') || 'Guest';
      const nameOnly = raw.includes('@') ? raw.split('@')[0] : raw;
      document.getElementById('welcome').textContent = `Welcome, ${nameOnly}`;
    });

    // การค้นหา
    const form = document.querySelector('form.search');
    const input = document.getElementById('q');
    form?.addEventListener('submit', () => {
      alert('ค้นหา: ' + (input.value || ''));
    });

    // จัดตำแหน่ง indicator + notch ให้ตรงกับปุ่มที่ active เมื่อโหลด/รีไซส์
    (function(){
      const bar = document.getElementById('tabbar');
      const indicator = bar.querySelector('.tab-indicator');
      const notch = bar.querySelector('.tab-notch');
      const tabs = Array.from(bar.querySelectorAll('.tab'));

      function moveTo(el){
        tabs.forEach(t => t.classList.remove('is-active'));
        el.classList.add('is-active');

        const r = el.getBoundingClientRect();
        const br = bar.getBoundingClientRect();
        const centerX = r.left + r.width/2 - br.left;

        indicator.style.transform = `translateX(${centerX - indicator.offsetWidth/2}px)`;
        notch.style.transform = `translateX(${centerX - notch.offsetWidth/2}px)`;
      }

      const current = bar.querySelector('.tab.is-active') || tabs[0];
      window.addEventListener('load', () => moveTo(current));
      window.addEventListener('resize', () => moveTo(current));
    })();

    const images = [
      "images/ป้องกันโรคเบาหวาน.jpg",
      "images/โรคเบาหวานคือ.jpg",
      "images/การวินิจฉัยโรคเบาหวาน.jpg",
      "images/เป้าหมายการดูแล.jpg"
    ];

    let currentIndex = 0;
    let autoRotate = true;

    function showImage(index) {
      currentIndex = index;
      document.getElementById("mainDisplay").src = images[currentIndex];
      autoRotate = false;
    }

    setInterval(() => {
      if (autoRotate) {
        currentIndex = (currentIndex + 1) % images.length;
        document.getElementById("mainDisplay").src = images[currentIndex];
      }
    }, 9000);
  </script>

</body>
</html>